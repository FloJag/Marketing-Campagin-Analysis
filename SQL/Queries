-- Test Join
SELECT c.Campaign_ID, c.Campaign_Name, c.Budget, cl.CompanyName
FROM Campaigns c
INNER JOIN Clients cl
ON c.Client_ID = cl.Client_ID
WHERE c.Campaign_ID = 5


-- Extra: avg cost per click
SELECT c.Campaign_ID, c.Campaign_Name, m.Clicks, p.Amount,
       ROUND(p.Amount/m.Clicks, 2) as 'Avg. Cost per Click'
FROM Campaigns c
LEFT JOIN Metrics m
ON c.Campaign_ID = m.Campaign_ID
LEFT JOIN Payments p
ON c.Campaign_ID = p.Campaign_ID


-- Extra: avg cost per conversion (Engagement)
SELECT c.Campaign_ID, c.Campaign_Name,m.Engagement, p.Amount,
       ROUND(p.Amount/m.Engagement, 2) as 'Avg. Cost per Conversion'
FROM Campaigns c
LEFT JOIN Metrics m
ON c.Campaign_ID = m.Campaign_ID
LEFT JOIN Payments p
ON c.Campaign_ID = p.Campaign_ID


-- Extra: Target Audience Performance
SELECT c.Target_Audience,
       sum(c.Budget) as Budget,
       sum(m.Impressions) as Impressions,
       sum(m.Clicks) as Clicks,
       sum(m.Engagement) as Engagement,
       avg(m.Conversion_Rate) as Conversion_rate,
       ROUND(p.Amount/m.Clicks, 2) as 'Avg. Cost per Click',
       ROUND(p.Amount/m.Engagement, 2) as 'Avg. Cost per Conversion'
FROM Campaigns c
LEFT JOIN Metrics m
ON c.Campaign_ID = m.Campaign_ID
LEFT JOIN Payments p
ON c.Campaign_ID = p.Campaign_ID
GROUP BY Target_Audience
